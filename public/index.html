<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ã€ç„¡æ–™ãƒ»è–¬å‰¤å¸«ç›£ä¿®ã€‘ä½“è³ªã‚¿ã‚¤ãƒ—ã§ã‚ã‹ã‚‹â€œæ¼¢æ–¹ã®é¸ã³æ–¹â€</title>
<style>
  /* === ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆï¼ˆãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œç‰ˆã‚’å«ã‚€ï¼‰ === */
  body { 
    font-family: "Hiragino Sans", "Yu Gothic", sans-serif; 
    margin: 0; 
    padding: 30px 20px; 
    background: #fafafa; 
    color: #333; 
    line-height: 1.6;
  }
  h1 { 
    text-align: center; 
    margin-bottom: 30px; 
    color: #333; 
    font-weight: 500;
    padding-bottom: 10px;
    border-bottom: 1px solid #ddd; 
  }
  .check-area {
    background: #fff; 
    padding: 30px;
    border: 1px solid #ddd; 
    margin-bottom: 40px;
  }
  .question { 
    margin: 30px 0; 
    padding: 20px 0; 
    border-bottom: 1px dashed #e0e0e0; 
  }
  .question:last-of-type { border-bottom: none; }
  .question strong { 
    display: block; 
    margin-bottom: 15px; 
    color: #598888; 
    font-size: 1.1em; 
    font-weight: 600;
  }
  .rating-container { 
    display: flex; 
    justify-content: space-between; 
    padding: 10px 0; 
    gap: 5px; 
  }
  .rating-container label { 
    text-align: center; 
    cursor: pointer; 
    padding: 8px 5px; 
    border-radius: 4px; 
    transition: background 0.2s, color 0.2s; 
    flex-grow: 1; 
    border: 1px solid #ccc; 
    background: #fff;
    font-size: 0.85em;
    color: #555;
    flex-basis: 25%; 
  }
  .rating-container input[type="radio"] { display: none; }
  .rating-container input[type="radio"]:checked + span { 
    background: #e0e0e0; 
    color: #333; 
    border: 1px solid #333; 
    padding: 8px 5px; 
    border-radius: 4px; 
    font-weight: bold; 
    box-shadow: none; 
  }
  .symptom-list { 
    display: grid; 
    grid-template-columns: 1fr 1fr; 
    gap: 10px; 
    padding-top: 10px; 
    padding-bottom: 15px; 
    border-bottom: 1px dashed #e0e0e0; 
    margin-bottom: 15px; 
  }
  .symptom-list label { 
    background: #f5f5f5; 
    border: 1px solid #ddd; 
    padding: 10px; 
    border-radius: 0; 
    display: block; 
    font-size: 0.9em;
  }
  .symptom-list input[type="checkbox"]:checked + span { 
    font-weight: 600; 
    color: #A85C5C; 
  }
  button#checkBtn { 
    width: 100%;
    margin-top: 40px; 
    padding: 15px 20px; 
    font-size: 18px; 
    background: #A85C5C; 
    color: #fff; 
    border: none; 
    cursor: pointer; 
    font-weight: bold;
  }
  button#checkBtn:hover { background: #8e4c4c; }
  .integrated-result-area { 
    margin-top: 40px; 
    padding: 30px; 
    border: 1px solid #ddd; 
    background: #fff; 
    display: none; 
  }
  .integrated-result-area h2 { 
    color: #333; 
    border-bottom: 1px solid #ccc; 
    padding-bottom: 15px; 
    margin-bottom: 25px; 
    font-weight: 500;
  }
  .explanation-box { 
    background: #f5f5f5; 
    padding: 20px; 
    border-left: 5px solid #598888; 
    margin-bottom: 30px; 
  }
  .explanation-box p { margin: 8px 0; }
  .explanation-box strong { color: #A85C5C; } 
  .result { 
    border: 1px solid #ddd; 
    padding: 15px; 
    margin-bottom: 15px; 
    cursor: pointer; 
    transition: all 0.2s; 
  }
  .result:hover { 
    background: #fcfcfc; 
    box-shadow: 0 1px 3px rgba(0,0,0,0.05); 
  }
  .result strong { color: #333; }
  .result-preview { font-size: 14px; color: #777; margin-top: 5px; }
  .detail { 
    margin-top: 15px; 
    background: #f9f9f9; 
    padding: 15px; 
    border-left: 3px solid #A85C5C; 
    display: none; 
    font-size: 0.9em;
  }
  .detail b { color: #333; font-weight: 600; }
  .detail a { 
    border-radius: 0; 
    display:inline-block; 
    padding:8px 15px; 
    margin-top:10px; 
    color:#fff; 
    text-decoration:none; 
    font-weight:bold;
    font-size: 0.9em;
    white-space: nowrap; 
  }
  .link-group {
    display: flex;
    flex-wrap: wrap; 
    gap: 10px; 
  }
  button#retryCheckBtn { 
    padding: 10px 20px; 
    font-size: 16px; 
    background: #598888 !important; 
    color: #fff; 
    border: none; 
    cursor: pointer;
  }
  .no-result-message {
    padding: 30px;
    border: 2px dashed #A85C5C;
    text-align: center;
    color: #A85C5C;
    font-weight: bold;
    margin-top: 20px;
  }
  .site-footer {
    text-align: center; 
    margin-top: 40px; 
    padding-top: 20px;
    border-top: 1px dashed #e0e0e0;
  }
  .site-footer p {
    font-size: 11px; 
    color: #999; 
    margin: 3px 0;
  }
  .site-footer .supervision-note {
    font-size: 1em;
    color: #598888;
    font-weight: bold;
    margin-bottom: 8px;
  }

  /* --- ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã§ã®æœ€é©åŒ– --- */
  @media (max-width: 600px) {
    body {
      padding: 15px 10px; 
    }
    h1 {
      font-size: 1.5em;
      margin-bottom: 20px;
    }
    .check-area, .integrated-result-area {
      padding: 15px; 
    }
    .question strong {
      font-size: 1em;
      margin-bottom: 10px;
    }
    
    .rating-container { 
      flex-direction: column; /* 1åˆ—ã«ç¸¦ä¸¦ã³ã«ã™ã‚‹ */
      flex-wrap: nowrap; /* æŠ˜ã‚Šè¿”ã—ã‚’ç„¡åŠ¹åŒ– */
      gap: 5px; /* éš™é–“ã‚’èª¿æ•´ */
    }
    .rating-container label {
      flex-basis: 100%; /* å¹…ã‚’ãƒ•ãƒ«ã«ã™ã‚‹ */
      font-size: 0.9em;
      padding: 10px 5px;
    }
    
    .symptom-list {
      grid-template-columns: 1fr; 
      gap: 5px;
    }
    .symptom-list label {
      padding: 8px 10px;
      font-size: 1em;
    }
    
    button#checkBtn {
      font-size: 16px;
      padding: 12px 15px;
    }
    
    .integrated-result-area h2 {
      font-size: 1.2em;
      padding-bottom: 10px;
    }
    .explanation-box {
      padding: 15px;
      font-size: 0.9em;
    }
    .result strong {
        font-size: 1em;
    }
    
    .link-group {
      flex-direction: column;
      gap: 5px;
      margin-top: 5px;
    }
    .link-group a {
      width: 100%; 
      text-align: center;
    }
  }
</style>
</head>
<body>

<h1>ã€ç„¡æ–™ãƒ»è–¬å‰¤å¸«ç›£ä¿®ã€‘ä½“è³ªã‚¿ã‚¤ãƒ—ã§ã‚ã‹ã‚‹â€œæ¼¢æ–¹ã®é¸ã³æ–¹â€</h1>

<div class="check-area" id="checkArea">
  <strong>Step 1: 2ã¤ã®å¿…é ˆè³ªå•ã¨ç—‡çŠ¶ã«ç­”ãˆã¦ä½“è³ªã‚’ãƒã‚§ãƒƒã‚¯</strong>
  
  <div class="question">
    <strong>â‘  ä½“åŠ›ã¨ç–²ã‚Œã‚„ã™ã•ã«ã¤ã„ã¦ï¼ˆè™šå®Ÿï¼‰</strong>
    <div class="rating-container" data-name="vitality">
      <label><input type="radio" name="vitality" value="1"><span>1. ç–²ã‚Œã‚„ã™ãã€ä½“åŠ›ãŒãªã„<br><span style="font-size: 0.8em;">(è™šè¨¼)</span></span></label>
      <label><input type="radio" name="vitality" value="2"><span>2. ã‚„ã‚„ç–²ã‚Œã‚„ã™ã„</span></label>
      <label><input type="radio" name="vitality" value="3"><span>3. ã‚„ã‚„ç–²ã‚Œã«ãã„</span></label>
      <label><input type="radio" name="vitality" value="4"><span>4. ç–²ã‚Œã«ããã€ä½“åŠ›ãŒã‚ã‚‹<br><span style="font-size: 0.8em;">(å®Ÿè¨¼)</span></span></label>
    </div>
  </div>

  <div class="question">
    <strong>â‘¡ æš‘ã•ãƒ»å¯’ã•ã®æ„Ÿã˜æ–¹ã«ã¤ã„ã¦ï¼ˆå¯’ç†±ï¼‰</strong>
    <div class="rating-container" data-name="temperature">
      <label><input type="radio" name="temperature" value="1"><span>1. å¸¸ã«å†·ãˆã‚’æ„Ÿã˜ã‚‹ï¼ˆå¯’ãŒã‚Šï¼‰<br><span style="font-size: 0.8em;">(å¯’è¨¼)</span></span></label>
      <label><input type="radio" name="temperature" value="2"><span>2. ã‚„ã‚„å¯’ãŒã‚Š</span></label>
      <label><input type="radio" name="temperature" value="3"><span>3. ã‚„ã‚„ã»ã¦ã‚‹</span></label>
      <label><input type="radio" name="temperature" value="4"><span>4. å¸¸ã«ã»ã¦ã‚Šã‚„ç†±ã‚’æ„Ÿã˜ã‚‹<br><span style="font-size: 0.8em;">(ç†±è¨¼)</span></span></label>
    </div>
  </div>

  <div class="question" style="border-bottom: none;">
    <strong>â‘¢ ç‰¹ã«æ°—ã«ãªã‚‹ç¾åœ¨ã®ä¸»ãªç—‡çŠ¶ã¯ï¼Ÿ</strong>
    <p style="font-size:0.9em; color:#777; margin-top:-5px; margin-bottom:10px;">
      âœ… ç—‡çŠ¶ã¯ä¸‹ã®ãƒªã‚¹ãƒˆã‹ã‚‰é¸æŠã—ã¦ãã ã•ã„ã€‚
    </p>
    <div class="symptom-list">
      <label><input type="checkbox" name="symptom" value="cold_and_circulation"> ğŸ§Š å†·ãˆãƒ»ç”Ÿç†ã®ãƒˆãƒ©ãƒ–ãƒ«</label>
      <label><input type="checkbox" name="symptom" value="stomach_and_digestion"> ğŸ¤¢ é£Ÿæ¬²ä¸æŒ¯ãƒ»èƒƒã‚‚ãŸã‚Œ</label>
      <label><input type="checkbox" name="symptom" value="water_and_swelling"> ğŸ’§ ã‚€ãã¿ãƒ»ã‚ã¾ã„ãƒ»è€³é³´ã‚Š</label>
      <label><input type="checkbox" name="symptom" value="fatigue_and_qi"> ğŸ˜´ ç–²ã‚Œãƒ»ã ã‚‹ã•ãƒ»æ°—åŠ›ã®ä½ä¸‹</label>
      <label><input type="checkbox" name="symptom" value="mental_and_stress"> ğŸ˜¤ ã‚¤ãƒ©ã‚¤ãƒ©ãƒ»ä¸çœ ãƒ»ã‚¹ãƒˆãƒ¬ã‚¹ãƒ»æ›´å¹´æœŸéšœå®³</label>
      <label><input type="checkbox" name="symptom" value="pain_and_stiffness"> ğŸ’†â€â™€ï¸ è‚©ã“ã‚Šãƒ»é ­ç—›ãƒ»é–¢ç¯€ã®ç—›ã¿</label>
      <label><input type="checkbox" name="symptom" value="symptom_cough"> ğŸ˜· å’³ãƒ»ç—°ãƒ»å–‰ã®ãƒˆãƒ©ãƒ–ãƒ«</label>
      <label><input type="checkbox" name="symptom" value="symptom_nose"> ğŸ‘ƒ é¼»æ°´ãƒ»é¼»ã¥ã¾ã‚Šãƒ»é¼»ç‚</label>
      <label><input type="checkbox" name="symptom" value="skin_and_pus"> ğŸ’Š æ¹¿ç–¹ãƒ»ãƒ‹ã‚­ãƒ“ãƒ»çš®è†šã®ç‚ç—‡</label>
      <label><input type="checkbox" name="symptom" value="urine_and_bladder"> ğŸš¾ é »å°¿ãƒ»è†€èƒ±ç‚ãƒ»æ’å°¿ã®ãƒˆãƒ©ãƒ–ãƒ«</label>
      <label><input type="checkbox" name="symptom" value="poo_and_colon"> ğŸš½ ä¾¿ç§˜ãƒ»ä¸‹ç—¢ãƒ»ç—”</label>
      <label><input type="checkbox" name="symptom" value="eye_and_ear"> ğŸ‘€ ç›®ã®ç–²ã‚Œãƒ»ã‹ã™ã¿ãƒ»ãƒ‰ãƒ©ã‚¤ã‚¢ã‚¤</label>
      
      </div>
  </div>

  <button id="checkBtn">ä½“è³ªã‚’ãƒã‚§ãƒƒã‚¯ã—ã€æ¼¢æ–¹ã‚’æ¤œç´¢</button>
</div>

<div id="integratedResultArea" class="integrated-result-area">
</div>

<footer class="site-footer">
<p class="supervision-note">ğŸ’¡ æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯è–¬å‰¤å¸«ãŒç›£ä¿®ã—ãŸæƒ…å ±æä¾›ãƒ„ãƒ¼ãƒ«ã§ã™</p>

<p style="font-size: 12px; color: #cc0000; font-weight: bold;">
  ã€é‡è¦ã€‘æœ¬ãƒ„ãƒ¼ãƒ«ã®çµæœã¯è¨ºæ–­ãƒ»æ²»ç™‚ã«ä»£ã‚ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
</p>
<p style="font-size: 12px; color: #cc0000; font-weight: bold; margin-top: 5px;">
  è‡ªå·±åˆ¤æ–­ã§ã®æœç”¨ã¯é¿ã‘ã€è³¼å…¥ãƒ»æœç”¨å‰ã«ã¯å¿…ãšåŒ»å¸«ã‚„è–¬å‰¤å¸«ã«ã”ç›¸è«‡ãã ã•ã„ã€‚
</p>
<p style="font-size: 11px; color: #999; margin-top: 10px;">
  â€»ã“ã®ã‚µã‚¤ãƒˆã¯æ¥½å¤©ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆãªã©ã®åºƒå‘Šåå…¥ã«ã‚ˆã£ã¦é‹å–¶ã•ã‚Œã¦ã„ã¾ã™ã€‚
</p>

<p style="margin-top: 20px; font-size: 11px; color: #333;">
  Â© <span id="current-year">2025</span> [ã€ç„¡æ–™ãƒ»è–¬å‰¤å¸«ç›£ä¿®ã€‘ä½“è³ªã‚¿ã‚¤ãƒ—ã§ã‚ã‹ã‚‹â€œæ¼¢æ–¹ã®é¸ã³æ–¹â€]. All Rights Reserved. 
  <br>å½“ã‚µã‚¤ãƒˆã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆè§£èª¬æ–‡ç« ã€ä½“è³ªè¨ºæ–­ãƒ­ã‚¸ãƒƒã‚¯ç­‰ï¼‰ã®ç„¡æ–­è»¢è¼‰ãƒ»è¤‡è£½ã‚’å›ºãç¦ã˜ã¾ã™ã€‚
</p>

<script>
    document.getElementById('current-year').textContent = new Date().getFullYear();
</script>

</footer>

<script>
    // ---------- ãƒ‡ãƒ¼ã‚¿ã®å®šç¾© ----------
    const SCORE_THRESHOLD = 150; // 300ã‹ã‚‰150ã¸å¤‰æ›´
    const MINIMUM_SCORE_THRESHOLD = SCORE_THRESHOLD; 
    const INDIVIDUAL_SCORE_THRESHOLD = SCORE_THRESHOLD; 
    
    // æ¼¢æ–¹è–¬ã®ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°é‡ã¿èª¿æ•´
    const SHO_WEIGHT = 45; 
    const SYMPTOM_WEIGHT = 50; 

    const SHO_MAPPINGS = {
      vitality: { 4: "ä½“åŠ›å……å®Ÿï¼ˆå®Ÿè¨¼ï¼‰", 3: "ã‚„ã‚„ç–²ã‚Œã«ãã„", 2: "ã‚„ã‚„ç–²ã‚Œã‚„ã™ã„", 1: "ç–²ã‚Œã‚„ã™ãä½“åŠ›ãŒãªã„ï¼ˆè™šè¨¼ï¼‰" },
      temperature: { 4: "æ¥µåº¦ã®ç†±ï¼ˆç†±è¨¼ï¼‰", 3: "ã‚„ã‚„ã»ã¦ã‚Š", 2: "ã‚„ã‚„å¯’è¨¼", 1: "å¸¸ã«å†·ãˆã‚’æ„Ÿã˜ã‚‹ï¼ˆå¯’è¨¼ï¼‰" }
    };
    
    // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆ
    const SYMPTOM_TO_KEYWORD = {
        "cold_and_circulation": ["å†·ãˆ", "ã—ã‚‚ã‚„ã‘", "ã—ã³ã‚Œ", "ç”Ÿç†ç—›", "ç”Ÿç†ä¸é †", "ç˜€è¡€", "è²§è¡€", "å†·ãˆæ€§", "è²§è¡€å‚¾å‘", "æœˆçµŒ", "çµŒè¡€", "è¡€æµ", "è¡€ã®å·¡ã‚Š", "ä¸‹è…¹éƒ¨ç—›", "æœˆçµŒç—›"],
        "stomach_and_digestion": ["é£Ÿæ¬²ä¸æŒ¯", "èƒƒã‚‚ãŸã‚Œ", "åãæ°—", "èƒ¸ã‚„ã‘", "èƒƒç—›", "ã¤ã‹ãˆ", "ã’ã£ã·", "æ¶ˆåŒ–", "ã¿ããŠã¡ã®ã¤ã‹ãˆ", "å‘‘é…¸", "é€†æµæ€§", "ã¿ããŠã¡"],
        "water_and_swelling": ["ã‚€ãã¿", "ã‚ã¾ã„", "æ°´æ¯’", "äºŒæ—¥é…”ã„", "ç«‹ã¡ãã‚‰ã¿", "é ­é‡", "æ°´æ§˜æ€§ä¸‹ç—¢", "æ°´å¤ªã‚Š", "è€³é³´ã‚Š", "ãµã‚‰ã¤ã"],
        "fatigue_and_qi": ["ç–²åŠ´å€¦æ€ ", "ä½“åŠ›ä½ä¸‹", "è™šå¼±", "ç—…å¾Œã®å›å¾©æœŸ", "å¯æ±—", "æ°—åŠ›", "å…¨èº«ã®æ „é¤Š", "æ°—è™š", "ä½“åŠ›ã®è¡°ãˆ", "æœãŒè‹¦æ‰‹"],
        "mental_and_stress": ["ã‚¤ãƒ©ã‚¤ãƒ©", "ä¸çœ ", "ä¸å®‰", "å‹•æ‚¸", "ã®ã¼ã›", "ç¥çµŒç—‡", "æƒ…ç·’ä¸å®‰å®š", "ãƒ’ã‚¹ãƒ†ãƒªãƒ¼çƒ", "æ›´å¹´æœŸéšœå®³", "æ›´å¹´æœŸ", "è‡ªå¾‹ç¥çµŒ", "ãƒ‘ãƒ‹ãƒƒã‚¯", "å–‰ã®é•å’Œæ„Ÿ", "åãæ°—"],
        "pain_and_stiffness": ["è‚©ã“ã‚Š", "é ­ç—›", "è…°ç—›", "é–¢ç¯€ã®ç—›ã¿", "ã“ã‚€ã‚‰è¿”ã‚Š", "ç¥çµŒç—›", "ã“ã‚ã°ã‚Š", "åé ­ç—›", "ç­‹ã‘ã„ã‚Œã‚“"],
        "symptom_cough": ["å’³", "ç—°", "å–‰", "æ°—ç®¡æ”¯ç‚", "å£°æ¯ã‚Œ", "ãœã‚“ãã", "ä¹¾ã„ãŸå’³", "æ°´ã£ã½ã„ç—°"], 
        "symptom_nose": ["é¼»æ°´", "é¼»ã¥ã¾ã‚Š", "é¼»ç‚", "ãã—ã‚ƒã¿", "è“„è†¿ç—‡", "å‰¯é¼»è…”ç‚", "ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼æ€§é¼»ç‚", "é¼»ã®å¥¥"], 
        "skin_and_pus": ["çš®è†šç‚", "ãƒ‹ã‚­ãƒ“", "æ¹¿ç–¹", "ã„ã¼", "ç—’ã¿", "åŒ–è†¿", "çš®è†šã®ä¹¾ç‡¥", "è•éº»ç–¹", "ã‚¢ãƒˆãƒ”ãƒ¼"],
        "urine_and_bladder": ["é »å°¿", "å¤œå°¿ç—‡", "å¤œé–“é »å°¿", "æ’å°¿æ™‚ç—›", "è†€èƒ±ç‚", "æ®‹å°¿æ„Ÿ", "è¡€å°¿", "æ’å°¿å›°é›£"],
        "poo_and_colon": ["ä¾¿ç§˜", "ä¸‹ç—¢", "ç—”", "è…¹éƒ¨è†¨æº€æ„Ÿ", "è…¹ç—›", "è¡€ä¾¿", "åˆ‡ã‚Œç—”", "ã—ã¶ã‚Šè…¹"],
        "eye_and_ear": ["ã‹ã™ã¿ç›®", "ç›®ã®ç–²ã‚Œ", "è¦–åŠ›ä½ä¸‹", "ãƒ‰ãƒ©ã‚¤ã‚¢ã‚¤", "ç›®ã®ä¹¾ç‡¥", "å……è¡€", "è€³ã®é–‰å¡æ„Ÿ", "è€³é³´ã‚Š"],
    };

    const KAMPOS = [
      { id: 'bofutsushosans', name: "é˜²é¢¨é€šè–æ•£", key_symptoms: ["è‚¥æº€", "ä¾¿ç§˜", "è‚©ã“ã‚Š", "é«˜è¡€åœ§å‚¾å‘", "ã‚€ãã¿", "ã®ã¼ã›", "çš®è†šç‚"], modern_action: "ä»£è¬ä¿ƒé€²ã€åˆ©å°¿ãƒ»æ’ä¾¿ä¿ƒé€²", sho_rank: { vitality: 4, temperature: 4 }, location: 'inner' },
      { id: 'yokukansan', name: "æŠ‘è‚æ•£", key_symptoms: ["ã‚¤ãƒ©ã‚¤ãƒ©", "ä¸çœ ", "ç¥çµŒç—‡", "å¤œæ³£ã", "ã‘ã„ã‚Œã‚“", "ãƒ‘ãƒ‹ãƒƒã‚¯", "è‡ªå¾‹ç¥çµŒ", "ä¸å®‰"], modern_action: "ä¸­æ¢ç¥çµŒé®é™ã€è‡ªå¾‹ç¥çµŒèª¿æ•´", sho_rank: { vitality: 2, temperature: 3 }, location: 'inner' },
      { id: 'hochuekkito', name: "è£œä¸­ç›Šæ°—æ¹¯", key_symptoms: ["ç–²åŠ´å€¦æ€ ", "é£Ÿæ¬²ä¸æŒ¯", "ä½“åŠ›ä½ä¸‹", "ç—…å¾Œã®å›å¾©æœŸ", "å¯æ±—"], modern_action: "å…ç–«å¼·åŒ–ã€æ¶ˆåŒ–æ©Ÿèƒ½æ”¹å–„", sho_rank: { vitality: 1, temperature: 3 }, location: 'inner' },
      { id: 'tokishakuyakusan', name: "å½“å¸°èŠè–¬æ•£", key_symptoms: ["å†·ãˆæ€§", "è²§è¡€å‚¾å‘", "ç”Ÿç†ä¸é †", "ã‚€ãã¿", "ã‚ã¾ã„", "è…°ç—›", "ä¸‹è…¹éƒ¨ç—›", "æœˆçµŒç—›"], modern_action: "è¡€æµæ”¹å–„ã€é€ è¡€ä¿ƒé€²ã€åˆ©æ°´ä½œç”¨", sho_rank: { vitality: 1, temperature: 1 }, location: 'inner' },
      { id: 'hangekobokuto', name: "åŠå¤åšæœ´æ¹¯", key_symptoms: ["å–‰ã®é•å’Œæ„Ÿ", "ãƒ’ã‚¹ãƒ†ãƒªãƒ¼çƒ", "åš¥ä¸‹", "ä¸å®‰æ„Ÿ", "å’³", "ã¤ã‚ã‚Š", "ç¥çµŒç—‡"], modern_action: "æŠ—ã‚¹ãƒˆãƒ¬ã‚¹ä½œç”¨ã€é®å’³ä½œç”¨", sho_rank: { vitality: 3, temperature: 3 }, location: 'inner' },
      { id: 'kamishoyosan', name: "åŠ å‘³é€é™æ•£", key_symptoms: ["æ›´å¹´æœŸéšœå®³", "ã‚¤ãƒ©ã‚¤ãƒ©", "æœˆçµŒä¸é †", "ä¸å®‰", "ã®ã¼ã›", "é ­ç—›", "è‡ªå¾‹ç¥çµŒ"], modern_action: "è‡ªå¾‹ç¥çµŒèª¿æ•´ã€æŠ—ã‚¹ãƒˆãƒ¬ã‚¹ä½œç”¨", sho_rank: { vitality: 2, temperature: 4 }, location: 'inner' },
      { id: 'kakkonto', name: "è‘›æ ¹æ¹¯", key_symptoms: ["é¢¨é‚ªã®ã²ãã¯ã˜ã‚", "é ­ç—›", "è‚©ã“ã‚Š", "ç™ºç†±", "æ±—ãŒå‡ºãªã„"], modern_action: "è¡€æµæ”¹å–„ã€ç­‹è‚‰ã®ã“ã‚ã°ã‚Šç·©å’Œ", sho_rank: { vitality: 4, temperature: 2 }, location: 'outer' },
      { id: 'shakuyakukanzoto', name: "èŠè–¬ç”˜è‰æ¹¯", key_symptoms: ["ã“ã‚€ã‚‰è¿”ã‚Š", "ç­‹ã‘ã„ã‚Œã‚“", "è¶³ã®ã¤ã‚Š", "è…¹ç—›", "æ€¥ãªç—›ã¿"], modern_action: "ç­‹è‚‰ã®ç—™æ”£æŠ‘åˆ¶ã€é®ç—›ä½œç”¨", sho_rank: { vitality: 3, temperature: 3 }, location: 'both' },
      { id: 'hachimijiogan', name: "å…«å‘³åœ°é»„ä¸¸", key_symptoms: ["é »å°¿", "å¤œé–“é »å°¿", "è…°ç—›", "å†·ãˆ", "è¶³è…°ã®ã ã‚‹ã•", "ã‹ã™ã¿ç›®", "ã‚€ãã¿", "è€åŒ–", "å€¦æ€ æ„Ÿ"], modern_action: "è…æ©Ÿèƒ½æ”¹å–„ã€ä¸‹åŠèº«ã®è¡€æµä¿ƒé€²", sho_rank: { vitality: 2, temperature: 1 }, location: 'inner' },
      { id: 'keishibukuryogan', name: "æ¡‚æèŒ¯è‹“ä¸¸", key_symptoms: ["æœˆçµŒç—›", "å­å®®ç­‹è…«", "æ›´å¹´æœŸéšœå®³", "è‚©ã“ã‚Š", "ã®ã¼ã›", "ã—ã¿", "ç”Ÿç†ç—›", "ç˜€è¡€"], modern_action: "è¡€æµæ”¹å–„ã€ç˜€è¡€é™¤å»", sho_rank: { vitality: 4, temperature: 4 }, location: 'inner' },
      { id: 'goreisan', name: "äº”è‹“æ•£", key_symptoms: ["ã‚€ãã¿", "ã‚ã¾ã„", "æ°´æ§˜æ€§ä¸‹ç—¢", "äºŒæ—¥é…”ã„", "å£æ¸‡", "é ­ç—›", "è€³é³´ã‚Š"], modern_action: "æ°´åˆ†ãƒãƒ©ãƒ³ã‚¹èª¿æ•´ã€åˆ©å°¿ä½œç”¨", sho_rank: { vitality: 3, temperature: 3 }, location: 'both' },
      { id: 'saikokaryukotsuboreito', name: "æŸ´èƒ¡åŠ ç«œéª¨ç‰¡è›æ¹¯", key_symptoms: ["ç²¾ç¥ä¸å®‰", "å‹•æ‚¸", "ä¸çœ ", "ã‚¤ãƒ©ã‚¤ãƒ©", "ä¾¿ç§˜", "é«˜è¡€åœ§å‚¾å‘", "ãƒ‘ãƒ‹ãƒƒã‚¯", "ãƒ’ã‚¹ãƒ†ãƒªãƒ¼", "è‡ªå¾‹ç¥çµŒ"], modern_action: "é®é™ã€è‡ªå¾‹ç¥çµŒèª¿æ•´ã€æŠ—ä¸å®‰ä½œç”¨", sho_rank: { vitality: 4, temperature: 3 }, location: 'inner' },
      { id: 'orengekotu', name: "é»„é€£è§£æ¯’æ¹¯", key_symptoms: ["ä¸çœ ", "ã‚¤ãƒ©ã‚¤ãƒ©", "ã®ã¼ã›", "èƒƒç‚", "å……è¡€", "äºŒæ—¥é…”ã„", "å£å†…ç‚"], modern_action: "ç‚ç—‡é®é™ã€ç²¾ç¥å®‰å®šã€ç†±ã‚’å†·ã¾ã™", sho_rank: { vitality: 4, temperature: 4 }, location: 'inner' },
      { id: 'choryoto', name: "çŒªè‹“æ¹¯", key_symptoms: ["æ’å°¿æ™‚ç—›", "æ®‹å°¿æ„Ÿ", "è¡€å°¿", "è†€èƒ±ç‚", "ã‚€ãã¿", "è…ç‚", "å¤œå°¿ç—‡"], modern_action: "åˆ©å°¿ã€æŠ—ç‚ç—‡ã€æ­¢è¡€ä½œç”¨", sho_rank: { vitality: 3, temperature: 4 }, location: 'inner' },
      { id: 'juzentaihoto', name: "åå…¨å¤§è£œæ¹¯", key_symptoms: ["æ¥µåº¦ã®ç–²åŠ´", "ç—…å¾Œã®å›å¾©æœŸ", "å†·ãˆ", "è²§è¡€", "æ‰‹è¶³ã®å†·ãˆ"], modern_action: "å…¨èº«ã®æ „é¤Šè£œçµ¦ã€å…ç–«è³¦æ´»", sho_rank: { vitality: 1, temperature: 2 }, location: 'inner' },
      { id: 'shoseiryuto', name: "å°é’ç«œæ¹¯", key_symptoms: ["æ°´ã£ã½ã„é¼»æ°´", "ãã—ã‚ƒã¿", "å’³", "æ°—ç®¡æ”¯ãœã‚“ãã", "ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼æ€§é¼»ç‚"], modern_action: "æŠ—ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ã€å»ç—°ã€é¼»æ°´æŠ‘åˆ¶", sho_rank: { vitality: 4, temperature: 2 }, location: 'outer' },
      { id: 'bakumondoto', name: "éº¦é–€å†¬æ¹¯", key_symptoms: ["ç—°ã®å‡ºãªã„å’³", "å–‰ã®ä¹¾ç‡¥", "å£°æ¯ã‚Œ", "æ°—ç®¡æ”¯ç‚", "å£æ¸‡"], modern_action: "ç²˜è†œã®æ½¤ã„è£œçµ¦ã€é®å’³ä½œç”¨", sho_rank: { vitality: 2, temperature: 4 }, location: 'inner' },
      { id: 'chotosan', name: "é‡£è—¤æ•£", key_symptoms: ["æ…¢æ€§çš„ãªé ­ç—›", "ã‚ã¾ã„", "é«˜è¡€åœ§", "ä½è¡€åœ§", "æœã®é ­é‡æ„Ÿ", "ã‚¤ãƒ©ã‚¤ãƒ©"], modern_action: "è„³è¡€æµæ”¹å–„ã€é®é™ä½œç”¨", sho_rank: { vitality: 3, temperature: 4 }, location: 'inner' },
      { id: 'goshuyuto', name: "å‘‰èŒ±è¸æ¹¯", key_symptoms: ["å†·ãˆã«ã‚ˆã‚‹é ­ç—›", "å˜”å", "æ‰‹è¶³ã®å†·ãˆ", "èƒƒã®å†·ãˆ", "ç‰‡é ­ç—›"], modern_action: "é®ç—›ã€é®åã€å…¨èº«æ¸©ã‚ä½œç”¨", sho_rank: { vitality: 2, temperature: 1 }, location: 'both' },
      { id: 'ryutanshakanto', name: "ç«œèƒ†ç€‰è‚æ¹¯", key_symptoms: ["æ’å°¿æ™‚ç—›", "é™°éƒ¨ã®ç—’ã¿", "è†€èƒ±ç‚", "æ€’ã‚Šã£ã½ã„", "é«˜è¡€åœ§"], modern_action: "æ¶ˆç‚ã€åˆ©å°¿ä½œç”¨ã€ç†±ã‚’å†·ã¾ã™", sho_rank: { vitality: 4, temperature: 4 }, location: 'inner' },
      { id: 'saikokeishikankyoto', name: "æŸ´èƒ¡æ¡‚æä¹¾å§œæ¹¯", key_symptoms: ["å£æ¸‡", "è²§è¡€", "å¾®ç†±", "ç¥çµŒéæ•", "è…¹ç—›", "ä¸å®‰"], modern_action: "è‡ªå¾‹ç¥çµŒèª¿æ•´ã€ä¸å®‰ç¥çµŒç—‡ã¸ã®å¯¾å¿œ", sho_rank: { vitality: 2, temperature: 2 }, location: 'inner' },
      { id: 'hangeshashinto', name: "åŠå¤ç€‰å¿ƒæ¹¯", key_symptoms: ["ã¿ããŠã¡", "ã¤ã‹ãˆ", "åãæ°—", "ä¸‹ç—¢", "å£å†…ç‚", "ç¥çµŒæ€§èƒƒç‚", "èƒ¸ã‚„ã‘"], modern_action: "æ¶ˆåŒ–ç®¡é‹å‹•èª¿æ•´ã€æŠ—ç‚ç—‡", sho_rank: { vitality: 4, temperature: 3 }, location: 'inner' },
      { id: 'ryonkeijutsukanto', name: "è‹“æ¡‚æœ®ç”˜æ¹¯", key_symptoms: ["ã‚ã¾ã„", "ç«‹ã¡ãã‚‰ã¿", "å‹•æ‚¸", "é ­é‡", "æ°´æ¯’", "ä½è¡€åœ§", "è€³é³´ã‚Š"], modern_action: "æ°´åˆ†ãƒãƒ©ãƒ³ã‚¹èª¿æ•´ã€è‡ªå¾‹ç¥çµŒå®‰å®š", sho_rank: { vitality: 2, temperature: 2 }, location: 'inner' },
      { id: 'goshajinkigan', name: "ç‰›è»Šè…æ°—ä¸¸", key_symptoms: ["é »å°¿", "å¤œé–“é »å°¿", "ã‚€ãã¿", "ã—ã³ã‚Œ", "åéª¨ç¥çµŒç—›", "è…°ç—›", "ä¸‹è‚¢ã®å†·ãˆ", "æ’å°¿å›°é›£"], modern_action: "è…æ©Ÿèƒ½è£œåŠ©ã€åˆ©å°¿ã€é®ç—›", sho_rank: { vitality: 2, temperature: 1 }, location: 'inner' },
      { id: 'chibakujiogan', name: "çŸ¥æŸåœ°é»„ä¸¸", key_symptoms: ["ã»ã¦ã‚Š", "å£æ¸‡", "é »å°¿", "è¶³è…°ã®å¼±ã‚Š", "å¯æ±—", "ã®ã¼ã›"], modern_action: "ç†±ã‚’å†·ã¾ã™ã€æ»‹é™°ä½œç”¨", sho_rank: { vitality: 1, temperature: 4 }, location: 'inner' },
      { id: 'tokakujokito', name: "æ¡ƒæ ¸æ‰¿æ°—æ¹¯", key_symptoms: ["ä¾¿ç§˜", "æœˆçµŒç—›", "æœˆçµŒä¸é †", "ã‚¤ãƒ©ã‚¤ãƒ©", "ã®ã¼ã›", "ç—”", "ç˜€è¡€"], modern_action: "ç˜€è¡€é™¤å»ã€ç€‰ä¸‹ä½œç”¨", sho_rank: { vitality: 4, temperature: 4 }, location: 'inner' },
      { id: 'tokishigyakukagoshuyushokyoto', name: "å½“å¸°å››é€†åŠ å‘‰èŒ±è¸ç”Ÿå§œæ¹¯", key_symptoms: ["æ‰‹è¶³ã®å¼·ã„å†·ãˆ", "ã—ã‚‚ã‚„ã‘", "å†·ãˆã«ã‚ˆã‚‹è…¹ç—›", "è…°ç—›"], modern_action: "æœ«æ¢¢è¡€ç®¡æ‹¡å¼µã€é®ç—›ã€å…¨èº«æ¸©ã‚ä½œç”¨", sho_rank: { vitality: 1, temperature: 1 }, location: 'inner' },
      { id: 'keigairengyoto', name: "èŠèŠ¥é€£ç¿¹æ¹¯", key_symptoms: ["æ…¢æ€§é¼»ç‚", "å‰¯é¼»è…”ç‚", "è“„è†¿ç—‡", "ãƒ‹ã‚­ãƒ“", "ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼", "æ‰æ¡ƒè…ºç‚"], modern_action: "æŠ—ç‚ç—‡ã€æ’è†¿ã€æ¸…ç†±è§£æ¯’ä½œç”¨", sho_rank: { vitality: 4, temperature: 4 }, location: 'inner' },
      { id: 'kakkontokasenkyushini', name: "è‘›æ ¹æ¹¯åŠ å·èŠè¾›å¤·", key_symptoms: ["é¼»ã¥ã¾ã‚Š", "æ…¢æ€§é¼»ç‚", "è“„è†¿ç—‡", "å‰¯é¼»è…”ç‚", "é ­ç—›", "é¢¨é‚ª"], modern_action: "é¼»ç²˜è†œã®è¡€æµæ”¹å–„ã€é®ç—›", sho_rank: { vitality: 4, temperature: 2 }, location: 'outer' },
      { id: 'shiniseihaito', name: "è¾›å¤·æ¸…è‚ºæ¹¯", key_symptoms: ["æ¿ƒã„é¼»æ°´", "é¼»ã¥ã¾ã‚Š", "è“„è†¿ç—‡", "å‰¯é¼»è…”ç‚"], modern_action: "é¼»ç²˜è†œã®ç‚ç—‡é®é™ã€æ’è†¿ä½œç”¨", sho_rank: { vitality: 4, temperature: 4 }, location: 'inner' },
      { id: 'keishikaryukotsuboreito', name: "æ¡‚æåŠ ç«œéª¨ç‰¡è›æ¹¯", key_symptoms: ["ç¥çµŒç—‡", "ä¸çœ ", "å‹•æ‚¸", "è™šå¼±è€…ã®ä¸å®‰", "ãƒ‘ãƒ‹ãƒƒã‚¯", "è‡ªå¾‹ç¥çµŒ"], modern_action: "é®é™ã€è‡ªå¾‹ç¥çµŒèª¿æ•´ã€æŠ—ä¸å®‰ä½œç”¨", sho_rank: { vitality: 2, temperature: 3 }, location: 'inner' },
      { id: 'kamikihito', name: "åŠ å‘³å¸°è„¾æ¹¯", key_symptoms: ["ä¸çœ ", "å‹•æ‚¸", "ä¸å®‰", "è²§è¡€", "é£Ÿæ¬²ä¸æŒ¯", "å¿ƒèº«ã®éåŠ´", "ã†ã¤", "éåŠ´", "å¯æ±—"], modern_action: "è£œè¡€ã€å¥èƒƒã€ç²¾ç¥å®‰å®š", sho_rank: { vitality: 1, temperature: 3 }, location: 'inner' },
      { id: 'otsujito', name: "ä¹™å­—æ¹¯", key_symptoms: ["ç—”æ ¸", "åˆ‡ã‚Œç—”", "è»½åº¦è„±è‚›", "ä¾¿ç§˜"], modern_action: "æŠ—ç‚ç—‡ã€ä¾¿é€šæ”¹å–„ã€æ­¢è¡€ä½œç”¨", sho_rank: { vitality: 4, temperature: 3 }, location: 'inner' },
      { id: 'keishikashakuyakuto', name: "æ¡‚æåŠ èŠè–¬æ¹¯", key_symptoms: ["è…¹ç—›", "ä¸‹ç—¢", "éæ•æ€§è…¸ç—‡å€™ç¾¤", "ã—ã¶ã‚Šè…¹", "ä¾¿ç§˜"], modern_action: "æ¶ˆåŒ–ç®¡é‹å‹•èª¿æ•´ã€é®ç—›ä½œç”¨", sho_rank: { vitality: 3, temperature: 2 }, location: 'inner' },
      { id: 'yokuinin', name: "ãƒ¨ã‚¯ã‚¤ãƒ‹ãƒ³", key_symptoms: ["ã„ã¼", "çš®è†šã®ã‚ã‚Œ", "è‚Œè’ã‚Œ", "ãƒ‹ã‚­ãƒ“"], modern_action: "æŠ—ç‚ç—‡ã€ä»£è¬æ”¹å–„", sho_rank: { vitality: 3, temperature: 3 }, location: 'both' },
      { id: 'jumihaitokuto', name: "åå‘³æ•—æ¯’æ¹¯", key_symptoms: ["æ¹¿ç–¹", "è•éº»ç–¹", "åŒ–è†¿æ€§çš®è†šç‚", "çš®è†šã®ã‹ã‚†ã¿"], modern_action: "æŠ—ç‚ç—‡ã€æ’è†¿ä½œç”¨", sho_rank: { vitality: 3, temperature: 4 }, location: 'outer' },
      { id: 'keishibukuryogankaiyokuinin', name: "æ¡‚æèŒ¯è‹“ä¸¸æ–™åŠ è–è‹¡ä»", key_symptoms: ["ã—ã¿", "ã«ãã³", "æœˆçµŒä¸é †", "æ‰‹è¶³ã®è’ã‚Œ", "ç”Ÿç†ç—›"], modern_action: "æ¡‚æèŒ¯è‹“ä¸¸ï¼‹çš®è†šæ”¹å–„ä½œç”¨", sho_rank: { vitality: 4, temperature: 4 }, location: 'inner' },
      { id: 'onshinin', name: "æ¸©æ¸…é£²", key_symptoms: ["çš®è†šç‚", "ã‚¢ãƒˆãƒ”ãƒ¼", "ã®ã¼ã›", "ä¸çœ ", "ã‚¤ãƒ©ã‚¤ãƒ©"], modern_action: "è¡€æµæ”¹å–„ã€æ¸…ç†±è§£æ¯’ã€ç²¾ç¥å®‰å®š", sho_rank: { vitality: 3, temperature: 4 }, location: 'inner' },
      { id: 'ireito', name: "èƒƒè‹“æ¹¯", key_symptoms: ["æ°´æ§˜æ€§ä¸‹ç—¢", "å˜”å", "é£Ÿã‚ãŸã‚Š", "æ°´æ§˜æ€§ã®è…¹ç—›", "ã‚€ãã¿"], modern_action: "æ¶ˆåŒ–ç®¡ã®æ°´åˆ†èª¿æ•´ã€å¥èƒƒã€åˆ©æ°´ä½œç”¨", sho_rank: { vitality: 3, temperature: 3 }, location: 'inner' },
      { id: 'rikkunsito', name: "å…­å›å­æ¹¯", key_symptoms: ["é£Ÿæ¬²ä¸æŒ¯", "èƒƒã‚‚ãŸã‚Œ", "èƒƒç—›", "åãæ°—", "ç–²ã‚Œ", "ã‚€ãã¿", "å‘‘é…¸", "ã¿ããŠã¡"], modern_action: "å¥èƒƒã€æŠ—å˜”åã€æ¶ˆåŒ–ä¿ƒé€²", sho_rank: { vitality: 1, temperature: 2 }, location: 'inner' },
      { id: 'makyokansekito', name: "éº»æç”˜çŸ³æ¹¯", key_symptoms: ["æ¿€ã—ã„å’³", "ãœã‚“ãã", "æ°—ç®¡æ”¯ç‚", "ç™ºç†±"], modern_action: "é®å’³ã€æ°—ç®¡æ”¯æ‹¡å¼µã€ç‚ç—‡æŠ‘åˆ¶", sho_rank: { vitality: 4, temperature: 4 }, location: 'outer' },
      { id: 'bÅiÅgito', name: "é˜²å·²é»„è€†æ¹¯", key_symptoms: ["æ°´å¤ªã‚Š", "ã‚€ãã¿", "é–¢ç¯€ç—›", "æ±—ã‹ã", "å€¦æ€ æ„Ÿ"], modern_action: "åˆ©æ°´ä½œç”¨ã€ç™ºæ±—æŠ‘åˆ¶ã€ä½“åŠ›å¢—å¼·", sho_rank: { vitality: 2, temperature: 3 }, location: 'inner' },
      { id: 'sokeikakketsuto', name: "ç–çµŒæ´»è¡€æ¹¯", key_symptoms: ["è…°ç—›", "ç¥çµŒç—›", "é–¢ç¯€ç—›", "ã—ã³ã‚Œ", "åéª¨ç¥çµŒç—›", "è¡€è¡Œä¸è‰¯"], modern_action: "ç˜€è¡€æ”¹å–„ã€é®ç—›ã€æŠ—ç‚ç—‡ä½œç”¨", sho_rank: { vitality: 3, temperature: 3 }, location: 'inner' },
      { id: 'mashininjan', name: "éº»å­ä»ä¸¸", key_symptoms: ["ä¾¿ç§˜", "é«˜é½¢è€…ã®ä¾¿ç§˜", "çš®è†šã®ä¹¾ç‡¥", "ã‚³ãƒ­ã‚³ãƒ­ä¾¿"], modern_action: "æ½¤è…¸ã€ç€‰ä¸‹ä½œç”¨", sho_rank: { vitality: 2, temperature: 4 }, location: 'inner' },
      { id: 'tÅkiinshi', name: "å½“å¸°é£²å­", key_symptoms: ["çš®è†šã®ã‹ã‚†ã¿", "æ¹¿ç–¹", "çš®è†šã®ä¹¾ç‡¥", "å†·ãˆ", "è™šå¼±è€…"], modern_action: "è¡€æµæ”¹å–„ã€çš®è†šã®ä¹¾ç‡¥æ”¹å–„", sho_rank: { vitality: 1, temperature: 2 }, location: 'inner' },
      { id: 'ninjinyoeito', name: "äººå‚é¤Šæ „æ¹¯", key_symptoms: ["ç—…å¾Œã®ä½“åŠ›ä½ä¸‹", "ç–²åŠ´å€¦æ€ ", "é£Ÿæ¬²ä¸æŒ¯", "è²§è¡€", "å†·ãˆ"], modern_action: "è£œæ°—è¡€ã€æ»‹é¤Šå¼·å£®ã€ç²¾ç¥å®‰å®š", sho_rank: { vitality: 1, temperature: 2 }, location: 'inner' },
      { id: 'shichimotsukoka', name: "ä¸ƒç‰©é™ä¸‹æ¹¯", key_symptoms: ["é«˜è¡€åœ§ã«ä¼´ã†é ­ç—›", "è‚©ã“ã‚Š", "ã‚ã¾ã„", "è™šå¼±ä½“è³ª", "é«˜è¡€åœ§"], modern_action: "è¡€åœ§èª¿æ•´ã€æ»‹é¤Šå¼·å£®", sho_rank: { vitality: 2, temperature: 3 }, location: 'inner' },
      { id: 'jinjintsÅ«jito', name: "æ»‹è…é€šè€³æ¹¯", key_symptoms: ["é›£è´", "è€³é³´ã‚Š", "ã‚ã¾ã„", "è€³ã®é–‰å¡æ„Ÿ"], modern_action: "è…æ©Ÿèƒ½è£œåŠ©ã€è€³å‘¨è¾ºã®è¡€æµæ”¹å–„", sho_rank: { vitality: 2, temperature: 3 }, location: 'inner' },
      { id: 'yokukansankachinpinhange', name: "æŠ‘è‚æ•£åŠ é™³çš®åŠå¤", key_symptoms: ["ã‚¤ãƒ©ã‚¤ãƒ©", "ä¸çœ ", "ç¥çµŒç—‡", "åãæ°—", "é£Ÿæ¬²ä¸æŒ¯", "ãƒ‘ãƒ‹ãƒƒã‚¯", "è‡ªå¾‹ç¥çµŒ", "ã¿ããŠã¡"], modern_action: "æŠ‘è‚æ•£ï¼‹å¥èƒƒæ•´è…¸ä½œç”¨", sho_rank: { vitality: 2, temperature: 3 }, location: 'inner' },
      { id: 'kikukujiogan', name: "æèŠåœ°é»„ä¸¸", key_symptoms: ["ç›®ã®ç–²ã‚Œ", "ã‹ã™ã¿ç›®", "è¦–åŠ›ä½ä¸‹", "é »å°¿", "ã»ã¦ã‚Š"], modern_action: "æ»‹é™°ã€è…æ©Ÿèƒ½è£œåŠ©ã€çœ¼ç²¾ç–²åŠ´æ”¹å–„", sho_rank: { vitality: 1, temperature: 4 }, location: 'inner' },
      { id: 'dokukatsukakkento', name: "ç‹¬æ´»è‘›æ ¹æ¹¯", key_symptoms: ["è‚©ã“ã‚Š", "é¦–ç­‹ã®ã“ã‚ã°ã‚Š", "è…•ã‚„è‚©ã®ç—›ã¿", "å†·ãˆ"], modern_action: "é®ç—›ã€è¡€è¡Œä¿ƒé€²", sho_rank: { vitality: 3, temperature: 2 }, location: 'outer' },
      { id: 'saikokeishikankyohangeto', name: "æŸ´èƒ¡æ¡‚æä¹¾å§œåŠå¤æ¹¯", key_symptoms: ["å¾®ç†±", "å£æ¸‡", "ç¥çµŒéæ•", "è…¹ç—›", "åãæ°—"], modern_action: "æŸ´èƒ¡æ¡‚æä¹¾å§œæ¹¯ï¼‹æ¶ˆåŒ–å™¨ç—‡çŠ¶æ”¹å–„", sho_rank: { vitality: 2, temperature: 2 }, location: 'inner' },
      { id: 'tokato', name: "æ¡ƒèŠ±æ¹¯", key_symptoms: ["ä¸‹è¡€", "è¡€ä¾¿", "ç—”ã‹ã‚‰ã®å‡ºè¡€"], modern_action: "æ­¢è¡€ã€åæ–‚", sho_rank: { vitality: 3, temperature: 3 }, location: 'inner' },
      { id: 'ryonkeikito', name: "è‹“æ¡‚å¸°ç—æ¹¯", key_symptoms: ["ã‚ã¾ã„", "å‹•æ‚¸", "ã‚€ãã¿", "è¶³è…°ã®å†·ãˆ", "ç¥çµŒç—‡", "è€³é³´ã‚Š"], modern_action: "è‹“æ¡‚æœ®ç”˜æ¹¯ï¼‹è£œè¡€ãƒ»æ¸©ã‚ä½œç”¨", sho_rank: { vitality: 2, temperature: 2 }, location: 'inner' },
      { id: 'keigaito', name: "æ¡‚è‰¾æ¹¯", key_symptoms: ["ä¸æ­£å‡ºè¡€", "ç”Ÿç†ç—›", "å†·ãˆ", "è…¹ç—›"], modern_action: "æ¸©çµŒæ­¢è¡€ã€é®ç—›", sho_rank: { vitality: 2, temperature: 1 }, location: 'inner' },
      { id: 'kakkontokahange', name: "è‘›æ ¹æ¹¯åŠ åŠå¤", key_symptoms: ["é¢¨é‚ª", "é ­ç—›", "è‚©ã“ã‚Š", "å’³", "ç—°"], modern_action: "è‘›æ ¹æ¹¯ï¼‹é®å’³ãƒ»å»ç—°ä½œç”¨", sho_rank: { vitality: 4, temperature: 2 }, location: 'outer' },
      { id: 'sansoin', name: "å‚è˜‡é£²", key_symptoms: ["é¢¨é‚ª", "å’³", "é£Ÿæ¬²ä¸æŒ¯", "èƒƒè…¸è™šå¼±è€…ã®é¢¨é‚ª"], modern_action: "è£œæ°—ã€å¥èƒƒã€è§£è¡¨ä½œç”¨", sho_rank: { vitality: 2, temperature: 2 }, location: 'outer' },
      { id: 'shimotsuketsusans', name: "å››ç‰©æ¹¯ï¼ˆå››ç‰©è¡€è¡Œæ•£ï¼‰", key_symptoms: ["è²§è¡€", "å†·ãˆæ€§", "ç”Ÿç†ä¸é †", "çš®è†šã®ä¹¾ç‡¥", "ç–²ã‚Œ"], modern_action: "è£œè¡€ä½œç”¨ã€è¡€æµæ”¹å–„ã€æ»‹é¤Šå¼·å£®", sho_rank: { vitality: 1, temperature: 2 }, location: 'inner' },
      { id: 'kyukichoketsuin', name: "èŠå¸°èª¿è¡€é£²", key_symptoms: ["ç”£å¾Œã®ä½“åŠ›å›å¾©", "ç–²åŠ´å€¦æ€ ", "è²§è¡€", "å†·ãˆ", "è…¹ç—›", "ä¸æ­£å‡ºè¡€"], modern_action: "è£œè¡€ã€è¡€æµæ”¹å–„ã€ç”£å¾Œã®ä½“åŠ›å›å¾©", sho_rank: { vitality: 2, temperature: 2 }, location: 'inner' },
      { id: 'wakamatsukanpo', name: "ãƒ¯ã‚«æœ«æ¼¢æ–¹ä¾¿ç§˜è–¬", key_symptoms: ["ä¾¿ç§˜", "è…¹éƒ¨è†¨æº€æ„Ÿ"], modern_action: "ç€‰ä¸‹ä½œç”¨", sho_rank: { vitality: 3, temperature: 3 }, location: 'inner' },
      { id: 'shigyokuseiwajo', name: "æ­¢é€†æ¸…å’ŒéŒ ", key_symptoms: ["èƒ¸ã‚„ã‘", "èƒƒã‚‚ãŸã‚Œ", "å‘‘é…¸", "é€†æµæ€§", "ã’ã£ã·"], modern_action: "åˆ¶é…¸ã€å¥èƒƒã€æ¶ˆåŒ–ä¿ƒé€²", sho_rank: { vitality: 3, temperature: 3 }, location: 'inner' },
      { id: 'onji', name: "ã‚ªãƒ³ã‚¸", key_symptoms: ["ç‰©å¿˜ã‚Œ", "è¨˜æ†¶åŠ›ã®ä½ä¸‹", "èªçŸ¥æ©Ÿèƒ½"], modern_action: "ä¸­æ¢ç¥çµŒè³¦æ´»ã€èªçŸ¥æ©Ÿèƒ½æ”¹å–„", sho_rank: { vitality: 3, temperature: 3 }, location: 'inner' },
      { id: 'geketsukosans', name: "ä¸‹è¡€åº·æ•£", key_symptoms: ["ä¸‹è¡€", "è¡€ä¾¿", "ç—”ã®å‡ºè¡€"], modern_action: "æ­¢è¡€ã€æŠ—ç‚ç—‡", sho_rank: { vitality: 3, temperature: 3 }, location: 'inner' },
      { id: 'kyokuhogedokui', name: "å±€æ–¹è§£æ¯’é£²", key_symptoms: ["çš®è†šã®è…«ã‚Œ", "åŒ–è†¿", "æ€¥æ€§çš®è†šç‚"], modern_action: "è§£æ¯’ã€æ¸…ç†±ã€æŠ—ç‚ç—‡", sho_rank: { vitality: 4, temperature: 4 }, location: 'outer' }
    ];

    const SINUS_KAMPOS = [
      'keigairengyoto', 
      'kakkontokasenkyushini', 
      'shiniseihaito',
      'shoseiryuto' 
    ];
    
    const COUGH_KAMPOS = [
      'bakumondoto', 
      'makyokansekito', 
      'shoseiryuto',
      'hangekobokuto', 
      'kakkontokahange'
    ];

    // ---------- è¨ºæ–­ãƒ­ã‚¸ãƒƒã‚¯é–¢æ•° ----------
    function getTraditionalShoName(vitality, temperature) {
        let v = vitality, t = temperature;
        
        if (v === 3 && t === 3) {
            return 'ä½“åŠ›ãƒ»å¯’ç†±ã¨ã‚‚ã«å¹³å‡çš„ (æ¥µç«¯ãªåã‚ŠãŒãªã„)';
        }
        
        let vResult = '';
        if (v === 1) vResult = 'è™šè¨¼';
        else if (v === 2) vResult = 'ã‚„ã‚„è™šè¨¼';
        else if (v === 3) vResult = 'ã‚„ã‚„å®Ÿè¨¼'; 
        else if (v === 4) vResult = 'å®Ÿè¨¼';

        let tResult = '';
        if (t === 1) tResult = 'å¯’è¨¼';
        else if (t === 2) tResult = 'ã‚„ã‚„å¯’è¨¼';
        else if (t === 3) tResult = 'ã‚„ã‚„ç†±è¨¼';
        else if (t === 4) tResult = 'ç†±è¨¼';
        
        return `${vResult} / ${tResult}`;
    }


    function filterResultsBySho(vitality, temperature) {
      const results = KAMPOS.map(kampo => {
        // æ¼¢æ–¹è–¬ã®sho_rank 5ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®4ã«å¤‰æ›ã—ã¦è·é›¢ã‚’è¨ˆç®— (æœ€å¤§è·é›¢ã‚’åˆ¶é™ã™ã‚‹ãŸã‚)
        const k_vitality = Math.min(kampo.sho_rank.vitality, 4); 
        const k_temperature = Math.min(kampo.sho_rank.temperature, 4); 
        
        const v_diff = Math.abs(k_vitality - vitality);
        const t_diff = Math.abs(k_temperature - temperature);
        const distance = Math.sqrt(v_diff * v_diff + t_diff * t_diff); 
        
        let sho_fit_score = 0;
        if (distance <= 0.5) { sho_fit_score = 3; } 
        else if (distance <= 1.5) { sho_fit_score = 2; } 
        else if (distance <= 2.5) { sho_fit_score = 1; } 
        else { sho_fit_score = 0; } 

        return { ...kampo, sho_fit_score, distance };
      }).filter(k => k.sho_fit_score > 0);
      return results;
    }

    function scoreResults(results, selectedSymptoms, userVitality, userTemperature) {
        const allKeywords = selectedSymptoms.flatMap(s => SYMPTOM_TO_KEYWORD[s] || []);
        
        let hasCheckedCough = selectedSymptoms.includes("symptom_cough");
        let hasCheckedNose = selectedSymptoms.includes("symptom_nose");

 return results.map(kampo => {
            let symptom_score = 0;
 let sho_penalty = 0; // æ–°ã—ã„è¨¼ã®ãƒšãƒŠãƒ«ãƒ†ã‚£å¤‰æ•°ã‚’å°å…¥

 // --- (1) è¨¼ã®æŸ”è»ŸãªãƒšãƒŠãƒ«ãƒ†ã‚£ãƒ­ã‚¸ãƒƒã‚¯ ---
 
 // è™šè¨¼è–¬ã«å¯¾ã™ã‚‹å®Ÿè¨¼ãƒšãƒŠãƒ«ãƒ†ã‚£ï¼ˆå½“å¸°èŠè–¬æ•£, è£œä¸­ç›Šæ°—æ¹¯ï¼‰
 if ((kampo.id === 'tokishakuyakusan' || kampo.id === 'hochuekkito') && userVitality === 4) {
 sho_penalty += 200; // å®Ÿè¨¼ã§ã®æ¶ˆåŒ–å¸åä¸è‰¯ãƒªã‚¹ã‚¯
 // å½“å¸°èŠè–¬æ•£ã¯ç†±è¨¼(T=4)ã¨ã®çµ„ã¿åˆã‚ã›ã§ã•ã‚‰ã«ãƒšãƒŠãƒ«ãƒ†ã‚£
 if (kampo.id === 'tokishakuyakusan' && userTemperature === 4) {
 sho_penalty += 100;
 }
 }
 
 // è‘›æ ¹æ¹¯ã€å°é’ç«œæ¹¯ã«å¯¾ã™ã‚‹ç†±è¨¼ãƒšãƒŠãƒ«ãƒ†ã‚£ (T=4)
 if ((kampo.id === 'kakkonto' || kampo.id === 'shoseiryuto') && userTemperature === 4) {
 sho_penalty += 200; 
 }

 // å…«å‘³åœ°é»„ä¸¸ã«å¯¾ã™ã‚‹ç†±è¨¼ãƒšãƒŠãƒ«ãƒ†ã‚£ (T=4)
 if (kampo.id === 'hachimijiogan' && userTemperature === 4) {
 sho_penalty += 150; // æ¯”è¼ƒçš„è»½ã‚ã®ãƒšãƒŠãƒ«ãƒ†ã‚£
 }
 
 // é˜²é¢¨é€šè–æ•£ã«å¯¾ã™ã‚‹æ¥µåº¦ã®è™šè¨¼ãƒšãƒŠãƒ«ãƒ†ã‚£ (V=1)
 if (kampo.id === 'bofutsushosans' && userVitality === 1) {
 sho_penalty += 400; // æœ€ã‚‚é‡ã„ãƒšãƒŠãƒ«ãƒ†ã‚£
 }
            
            allKeywords.forEach(keyword => {
                if (kampo.key_symptoms.some(s => s.includes(keyword))) {
                    symptom_score += 2.0; 
                }
            });
 
            // --- (2) ç—‡çŠ¶ãƒšãƒŠãƒ«ãƒ†ã‚£ã®å¼·åŒ– ---
            const HUGE_PENALTY_FOR_COUGH_NOSE = 400; // ãƒšãƒŠãƒ«ãƒ†ã‚£ã‚’å¼·åŒ–
            if ((hasCheckedCough || hasCheckedNose) && kampo.id === 'shakuyakukanzoto') {
                symptom_score -= HUGE_PENALTY_FOR_COUGH_NOSE;
            }

 // æœ€çµ‚ã‚¹ã‚³ã‚¢ã®è¨ˆç®—
 let final_score = kampo.sho_fit_score * SHO_WEIGHT + symptom_score * SYMPTOM_WEIGHT - sho_penalty;
 
 // ã‚¹ã‚³ã‚¢ãŒãƒã‚¤ãƒŠã‚¹ã«ãªã‚‹å ´åˆã¯ã€0ã«è¨­å®šã—ã¦è¡¨ç¤ºé †ã«å½±éŸ¿ã•ã›ãªã„ (ã¾ãŸã¯ãã®ã¾ã¾ãƒã‚¤ãƒŠã‚¹ã«ã—ã¦æœ€ä¸‹ä½ã«æ²ˆã‚ã‚‹)
            final_score = Math.max(0, final_score); 

            return { 
                ...kampo, 
                symptom_score: symptom_score.toFixed(1), 
                final_score,
                matched_keywords: allKeywords.filter(keyword => kampo.key_symptoms.some(s => s.includes(keyword)))
            };
        }).sort((a, b) => b.final_score - a.final_score); 
    }

    function highlightKeywords(symptoms, matchedKeywords) {
        let result = symptoms.join("ã€");
        matchedKeywords.forEach(keyword => {
            const regex = new RegExp(`(${keyword})`, 'gi'); 
            result = result.replace(regex, `<b style="color:#A85C5C;">$1</b>`); 
        });
        return result;
    }
    
    // ---------- ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç† ----------
    const checkBtn = document.getElementById("checkBtn");
    const integratedResultArea = document.getElementById("integratedResultArea");
    const checkArea = document.getElementById("checkArea");

    // âš ï¸ æ¥½å¤©ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆãƒªãƒ³ã‚¯ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å®šç¾© (ã‚ãªãŸã®ãƒªãƒ³ã‚¯ã«æ›¸ãæ›ãˆã¦ãã ã•ã„)
    const RAKUTEN_AFFILIATE_LINK_TEMPLATE = "https://hb.afl.rakuten.co.jp/hgc/4f0b04d7.de90e954.4f0b04d8.eed36ea2/?pc=https%3A%2F%2Fsearch.rakuten.co.jp%2Fsearch%2Fmall%2F"; 
    // âš ï¸ Amazonã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒˆãƒªãƒ³ã‚¯ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å®šç¾© (ã‚ãªãŸã®IDã¨ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚¿ã‚°ã‚’å«ã‚ã¦ãã ã•ã„)
    const AMAZON_AFFILIATE_LINK_TEMPLATE = "https://www.amazon.co.jp/s?k="; 
    // âš ï¸ ãã®ä»–ã®ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆï¼ˆA8ãªã©ï¼‰ã®ãƒªãƒ³ã‚¯ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å®šç¾©
    const OTHER_AFFILIATE_LINK_TEMPLATE = "https://www.google.com/search?q="; 

    checkBtn.addEventListener("click", () => {
      const vitalityInput = document.querySelector('input[name="vitality"]:checked')?.value;
      const temperatureInput = document.querySelector('input[name="temperature"]:checked')?.value;
      const selectedSymptomElements = document.querySelectorAll('input[name="symptom"]:checked');
      const selectedSymptoms = Array.from(selectedSymptomElements).map(el => el.value);

      // --- å¤‰æ›´ç‚¹ï¼šå…¥åŠ›ãƒã‚§ãƒƒã‚¯ã®å¼·åŒ– ---
      if (!vitalityInput || !temperatureInput) { 
        alert("ä½“è³ªãƒã‚§ãƒƒã‚¯ã®å¿…é ˆè³ªå•ï¼ˆâ‘ ä½“åŠ›ã€â‘¡å¯’ç†±ï¼‰ã«ç­”ãˆã¦ãã ã•ã„ã€‚");
        return;
      }
      
      if (selectedSymptoms.length === 0) {
        alert("â‘¢ ç‰¹ã«æ°—ã«ãªã‚‹ä¸»ãªç—‡çŠ¶ã‚’ã€ãƒªã‚¹ãƒˆã‹ã‚‰æœ€ä½1ã¤ä»¥ä¸Šé¸æŠã—ã¦ãã ã•ã„ã€‚");
        return;
      }
      // ------------------------------------
      
      const vitality = parseInt(vitalityInput);
      const temperature = parseInt(temperatureInput);
      
      const traditionalSho = getTraditionalShoName(vitality, temperature);
      
      let vitality_main_desc = vitality <= 2 ? 'ä½“åŠ›ãŒä¹ã—ãã€ç–²ã‚Œã‚„ã™ã„' : vitality >= 4 ? 'ä½“åŠ›ãŒã‚ã‚Šã€ç–²ã‚Œã«ãã„' : 'ä½“åŠ›ãŒæ¥µç«¯ã«å¼±ããªã„ã€å¹³å‡çš„';
      
      let temperature_main_desc = temperature === 1 ? 'å¸¸ã«å†·ãˆã‚’æ„Ÿã˜ã‚‹'
                                  : temperature === 2 ? 'ã‚„ã‚„å†·ãˆã‚’æ„Ÿã˜ã‚„ã™ã„'
                                  : temperature === 4 ? 'å¸¸ã«ã»ã¦ã‚Šã‚„ç†±ã‚’æ„Ÿã˜ã‚‹'
                                  : 'å¯’ãŒã‚Šã§ã‚‚ã€ã»ã¦ã‚Šã‚„ã™ã„æ–¹ã§ã‚‚ãªã„';
      
      let overall_description;
      if (vitality <= 2 && temperature <= 2) {
          overall_description = "å†·ãˆã‚„ã™ãã€ç–²ã‚ŒãŒæŠœã‘ã«ãã„";
      } else if (vitality <= 2 && temperature >= 4) {
          overall_description = "ã»ã¦ã‚Šã‚„ã™ãã€ä½“åŠ›ã¯ã‚ã¾ã‚Šãªã„"; 
      } else if (vitality >= 4 && temperature <= 2) {
          overall_description = "ä½“åŠ›ã¯ã‚ã‚‹ãŒã€å†·ãˆã‚„ã™ã„"; 
      } else if (vitality >= 4 && temperature >= 4) {
          overall_description = "ä½“åŠ›ãŒã‚ã‚Šã€ç†±ãŒã“ã‚‚ã‚Šã‚„ã™ã„"; 
      } else if (vitality === 3 && temperature === 3) {
          overall_description = "ä½“åŠ›ã¯æ¥µç«¯ã«å¼±ããªãã€å¯’ãŒã‚Šã§ã‚‚ã»ã¦ã‚Šã‚„ã™ã„æ–¹ã§ã‚‚ãªã„"; 
      } else {
          overall_description = `${temperature_main_desc}ã§ã€${vitality_main_desc}å‚¾å‘ã«ã‚ã‚‹`;
      }


      let explanationHtml = `<h2>Step 2: ã‚ãªãŸã«æ¨å®šã•ã‚Œã‚‹è¨¼ï¼ˆä½“è³ªãƒ»ç—…æ…‹ï¼‰ã¨ã€è¨¼ã«åˆã£ãŸæ¼¢æ–¹è–¬ã®å‚è€ƒä¾‹</h2>`;
      
      explanationHtml += `<div class="explanation-box" id="explanationBox">`;
      explanationHtml += `<h3>ğŸ’¡ ã‚ãªãŸã®ä½“è³ªã‚¿ã‚¤ãƒ—ã¨å‚¾å‘</h3>`;
      
      explanationHtml += `<p style="font-size: 1.1em; font-weight: bold;">
          ã‚ãªãŸã®è¨¼ã‚¿ã‚¤ãƒ—ã¯ã€Œ${traditionalSho}ã€ã€ã¤ã¾ã‚Šã€Œ${overall_description}ã€ã¨æ¨å®šã•ã‚Œã¾ã—ãŸã€‚
      </p>`;
      
      let vitality_explanation = vitality <= 2 
          ? 'ä½“åŠ›ãŒä¹ã—ãã€ç–²ã‚Œã‚„ã™ã„ã‚¿ã‚¤ãƒ—ï¼ˆè™šè¨¼ï¼‰ã§ã™ã€‚ä½“å…¨ä½“ã‚’æ»‹é¤Šãƒ»è£œçµ¦ã™ã‚‹æ¼¢æ–¹ãŒåˆã„ã‚„ã™ã„ã§ã—ã‚‡ã†ã€‚' 
          : vitality >= 4
          ? 'ä½“åŠ›ãŒå……å®Ÿã—ã¦ãŠã‚Šã€ç–²ã‚Œã«ãã„ã‚¿ã‚¤ãƒ—ï¼ˆå®Ÿè¨¼ï¼‰ã§ã™ã€‚ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’ç™ºæ•£ã•ã›ã‚‹æ¼¢æ–¹ãŒåˆã„ã‚„ã™ã„ã§ã—ã‚‡ã†ã€‚'
          : 'ä½“åŠ›ãŒæ¥µç«¯ã«å¼±ããªã„ã€å¹³å‡çš„ãªä½“åŠ›ã®ã‚¿ã‚¤ãƒ—ã§ã™ã€‚';

      let temperature_explanation;
      if (temperature === 1) {
          temperature_explanation = 'å¸¸ã«å†·ãˆã‚’å¼·ãæ„Ÿã˜ã‚‹ã‚¿ã‚¤ãƒ—ï¼ˆå¯’è¨¼ï¼‰ã§ã™ã€‚ä½“ã‚’æ¸©ã‚ã‚‹ä½œç”¨ã‚’æŒã¤æ¼¢æ–¹ãŒæ¨å¥¨ã•ã‚Œã¾ã™ã€‚';
      } else if (temperature === 4) {
          temperature_explanation = 'ã»ã¦ã‚Šã‚„ç†±ãŒã“ã‚‚ã‚Šã‚„ã™ã„ã‚¿ã‚¤ãƒ—ï¼ˆç†±è¨¼ï¼‰ã§ã™ã€‚ä½“ã®ç†±ã‚’å†·ã¾ã™æ¼¢æ–¹ãŒæ¨å¥¨ã•ã‚Œã¾ã™ã€‚';
      } else if (temperature === 2) { 
          temperature_explanation = 'å†·ãˆã‚‚ã»ã¦ã‚Šã‚‚æ¥µç«¯ã«ã¯æ„Ÿã˜ãªã„ã‚¿ã‚¤ãƒ—ã§ã™ã€‚ãŸã ã—ã€ã‚„ã‚„å†·ãˆï¼ˆå¯’è¨¼å‚¾å‘ï¼‰ãŒã‚ã‚‹ãŸã‚ã€ä½“ã‚’æ¸©ã‚ã‚‹æ¼¢æ–¹ã‚‚é¸æŠè‚¢ã«å…¥ã‚Šã¾ã™ã€‚'; 
      } else {
          temperature_explanation = 'å†·ãˆã‚‚ã»ã¦ã‚Šã‚‚æ¥µç«¯ã«ã¯æ„Ÿã˜ãªã„ã‚¿ã‚¤ãƒ—ã§ã™ã€‚ãŸã ã—ã€ã‚„ã‚„ã»ã¦ã‚Šï¼ˆç†±è¨¼å‚¾å‘ï¼‰ãŒã‚ã‚‹ãŸã‚ã€ç†±ã‚’å†·ã¾ã™æ¼¢æ–¹ã‚‚é¸æŠè‚¢ã«å…¥ã‚Šã¾ã™ã€‚'; 
      }


      explanationHtml += `<p style="margin-top: 15px;">
          ã€ä½“åŠ›ã®å‚¾å‘ï¼ˆè™šå®Ÿï¼‰ã€‘<br>
          ${vitality_explanation}
      </p>`;
      explanationHtml += `<p>
          ã€å¯’ç†±ã®å‚¾å‘ã€‘<br>
          ${temperature_explanation}
      </p>`;
      
      explanationHtml += `</div>`;
      
      let filteredResults = filterResultsBySho(vitality, temperature);
      filteredResults = scoreResults(filteredResults, selectedSymptoms, vitality, temperature); 
      
      const highestScore = filteredResults.length > 0 ? filteredResults[0].final_score : 0;
      
      const topResults = filteredResults
                            .filter(k => k.final_score >= INDIVIDUAL_SCORE_THRESHOLD) 
                            .slice(0, 3);
      
      if (highestScore >= MINIMUM_SCORE_THRESHOLD && topResults.length > 0) {
          
          explanationHtml += `<h3 style="color:#598888; margin-top:25px;">è¨¼ã«åˆè‡´ã—ã€ç—‡çŠ¶ã¸ã®å¯¾å¿œåº¦ãŒé«˜ã„æ¼¢æ–¹è–¬ã®**ä¸Šä½${topResults.length}ã¤**</h3>`;
          explanationHtml += `<div id="resultList">`;

          explanationHtml += topResults.map((k, index) => {
            const sho_fit_text = k.sho_fit_score >= 3 ? 'âœ… æœ€é©åˆ' : k.sho_fit_score >= 2 ? 'â–³ é©åˆ' : 'â–³ ã‚„ã‚„é©åˆ';
            const highlightedSymptoms = highlightKeywords(k.key_symptoms, k.matched_keywords);

            let isFirst = index === 0; // 1ä½ã‹ã©ã†ã‹ã‚’åˆ¤å®šã™ã‚‹ãƒ•ãƒ©ã‚°
            
            // ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆãƒªãƒ³ã‚¯ã‚’ç”Ÿæˆ
            const search_query = encodeURIComponent(k.name);
            const rakutenLink = RAKUTEN_AFFILIATE_LINK_TEMPLATE + search_query;
            const amazonLink = AMAZON_AFFILIATE_LINK_TEMPLATE + search_query;
            const otherLink = OTHER_AFFILIATE_LINK_TEMPLATE + search_query + "+å…¬å¼";

            let k_vitality_desc;
            if (k.sho_rank.vitality <= 2) {
              k_vitality_desc = 'ä½“åŠ›ãŒä¹ã—ãè™šå¼±ãªæ–¹';
            } else if (k.sho_rank.vitality >= 4) {
              k_vitality_desc = 'ä½“åŠ›ãŒã‚ã‚Šé ‘ä¸ˆãªæ–¹';
            } else {
              k_vitality_desc = 'ä½“åŠ›ãŒæ¥µç«¯ã«å¼±ããªã„ã€å¹³å‡çš„ãªæ–¹'; 
            }

            let k_temperature_desc;
            if (k.sho_rank.temperature <= 2) {
              k_temperature_desc = 'å¯’ãŒã‚Šã®æ–¹';
            } else if (k.sho_rank.temperature >= 4) {
              k_temperature_desc = 'ã»ã¦ã‚Šã‚„ã™ã„æ–¹';
            } else {
              k_temperature_desc = 'å†·ãˆã‚‚ã»ã¦ã‚Šã‚‚å¼·ãæ„Ÿã˜ãªã„æ–¹'; 
            }
            
            let sho_summary = `ã“ã®æ¼¢æ–¹ã¯${k_vitality_desc}ã€${k_temperature_desc}ã®ä½“è³ªï¼ˆè¨¼ï¼‰ã«é©åˆã™ã‚‹å‚¾å‘ãŒã‚ã‚Šã¾ã™ã€‚`;


            return `
              <div class="result" role="button" tabindex="0" aria-expanded="${isFirst ? 'true' : 'false'}" data-kampo-id="${k.id}">
                <strong>${index + 1}ä½: ${k.name}</strong> 
                
                <div class="result-preview">
                  è¨¼ã‚¿ã‚¤ãƒ—: ${sho_fit_text} ï¼ æ¼¢æ–¹ã®ä½“åŠ›å‚¾å‘ï¼š${k.sho_rank.vitality} ï¼ æ¼¢æ–¹ã®å¯’ç†±å‚¾å‘ï¼š${k.sho_rank.temperature}
                </div>
                
                <p style="font-size: 0.9em; margin-top: 5px; color: #A85C5C; font-weight: 500;">${sho_summary}</p>

                <div class="detail" style="display: ${isFirst ? 'block' : 'none'};">
                  <p><b>ä¸»ãªç—‡çŠ¶ï¼š</b>${highlightedSymptoms}</p>
                  <p><b>ç¾ä»£è–¬å­¦çš„ä½œç”¨ï¼š</b>${k.modern_action}</p>
                  
                  <div class="link-group">
                    <a class="detail-link"
                       href="${rakutenLink}" 
                       target="_blank" 
                       style="background: #A85C5C; border: 1px solid #A85C5C;">
                       ğŸ›ï¸ æ¥½å¤©å¸‚å ´ã§ã€Œ${k.name}ã€ã‚’è¦‹ã‚‹
                    </a>
                    
                    <a class="detail-link"
                       href="${amazonLink}" 
                       target="_blank" 
                       style="background: #FF9900; border: 1px solid #FF9900;">
                       ğŸ›’ Amazonã§ã€Œ${k.name}ã€ã‚’æ¢ã™
                    </a>

                    <a class="detail-link"
                       href="${otherLink}" 
                       target="_blank" 
                       style="background: #598888; border: 1px solid #598888;">
                       ğŸ”— ãã®ä»–ã®è²©å£²ã‚µã‚¤ãƒˆã‚’è¦‹ã‚‹
                    </a>

                    <a class="detail-link"
                       href="https://www.google.com/search?q=${k.name}+åŠ¹èƒ½+æ·»ä»˜æ–‡æ›¸" target="_blank"
                       style="background: #333; border: 1px solid #333;">
                       ğŸ“„ è©³ç´°ã‚’èª¿ã¹ã‚‹
                    </a>
                  </div>

                  <p style="margin-top: 10px; font-size: 0.9em; color:#999;">â€»ã‚ãªãŸã®è¨¼ã¨ã®è·é›¢ï¼š${k.distance.toFixed(1)} / æœ€çµ‚ã‚¹ã‚³ã‚¢ï¼š${k.final_score.toFixed(1)}</p>
                  
                </div>
              </div>
            `;
          }).join('');
          explanationHtml += `</div>`;
      } else {
          explanationHtml += `
            <div class="no-result-message">
              <h3>è©²å½“ã™ã‚‹æ¼¢æ–¹è–¬ã®ä¾‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</h3>
              <p>é¸æŠã•ã‚ŒãŸè¨¼ï¼ˆä½“è³ªãƒ»ç—…æ…‹ï¼‰ã¨ç—‡çŠ¶ã®ä¸¡æ–¹ã«å¼·ãåˆè‡´ã™ã‚‹ã€ä»£è¡¨çš„ãªæ¼¢æ–¹è–¬ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>
              <p>æ¼¢æ–¹è–¬ã®é¸å®šã¯é›£ã—ãã€è©³ç´°ãªå•è¨ºãŒå¿…è¦ã§ã™ã€‚æ¼¢æ–¹ã®å°‚é–€å®¶ã‚„åŒ»å¸«ã«ã”ç›¸è«‡ãã ã•ã„ã€‚</p>
              <p style="font-size:0.8em; color:#A85C5C;">(æœ€é«˜ã‚¹ã‚³ã‚¢: ${highestScore.toFixed(1)}ç‚¹) </p>
            </div>
          `;
      }


      explanationHtml += `<p style="font-size:0.9em; color:#666; margin-top:20px;">
        â€»ã“ã®çµæœã¯ã€Œä½“åŠ›ã€ã€Œå¯’ç†±ã€ã®é©åˆåº¦ã«åŸºã¥ãã€ã€Œç—‡çŠ¶ä¸€è‡´åº¦ã€ã§ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸä¾‹ã§ã™ã€‚æœ€çµ‚çš„ãªæ¼¢æ–¹è–¬ã®é¸æŠã¯ã€å°‚é–€çš„ãªè¨ºå¯ŸãŒå¿…è¦ã§ã™ã€‚
      </p>`;
      explanationHtml += `<div style="text-align:center; margin-top: 30px;"><button id="retryCheckBtn">ä½“è³ªãƒã‚§ãƒƒã‚¯ã‚’ã‚„ã‚Šç›´ã™</button></div>`;


      integratedResultArea.innerHTML = explanationHtml;
      
      document.querySelectorAll('.result').forEach(el => {
          el.addEventListener('click', toggleDetail);
          el.addEventListener('keydown', e => {
            if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggleDetail({ currentTarget: el }); }
          });
      });

      document.getElementById('retryCheckBtn').addEventListener('click', () => {
        integratedResultArea.style.display = 'none';
        checkArea.style.display = 'block';
        checkArea.scrollIntoView({ behavior: 'smooth' });
        document.querySelectorAll('input[type="radio"]:checked, input[type="checkbox"]:checked').forEach(input => input.checked = false);
      });

      checkArea.style.display = 'none';
      integratedResultArea.style.display = 'block';
      integratedResultArea.scrollIntoView({ behavior: 'smooth' });
    });
    
    function toggleDetail(event) {
      const resultEl = event.currentTarget || event;
      const detail = resultEl.querySelector('.detail');
      const isExpanded = detail.style.display === 'block';
      detail.style.display = isExpanded ? 'none' : 'block';
      resultEl.setAttribute('aria-expanded', !isExpanded);
    }

    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«åˆæœŸè¨­å®šã‚’è¡Œã† (ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«)
    window.addEventListener('load', () => {
        // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ã‚’éè¡¨ç¤ºã«
        integratedResultArea.style.display = 'none';
    });
</script>

</body>
</html>
